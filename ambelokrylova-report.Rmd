---
title: 'HW 1: Какие проблемы есть в авиаперевозках; возможные пути их решения'
author: "Белокрылова Анна, ambelokrylova"
output: html_document
---

## Задача

на основе данных (и выданных вопросов) постараться выяснить:

* какие проблемы есть в авиаперевозках
* какие улучшения можно предложить на основе выводов по данным

#### Загрузка данных и преобразование

```{r message = FALSE, warning=FALSE, echo = F}
library(dplyr)
library(ggplot2)

source("~/shared/minor2_2022/1-Intro/hw1/hw1_data.R")

airline = hw1_get_data(df_name = "airline")
airport = hw1_get_data(df_name = "airport")
lounge = hw1_get_data(df_name = "lounge")
seat = hw1_get_data(df_name = "seat")

hw1_get_questions()
```



### Вопросы

#### Вопрос 1

**Вопрос:** Какие типы путешественников (type_traveller) поставили самые высокие оценки по критерию оценок за очереди?

**Данные:** для ответа на вопрос нужна таблица airport

```{r message = FALSE, warning=FALSE, echo = F}
airport1 <- filter(airport, !is.na(queuing_rating))
airport1 <- filter(airport1, !is.na(type_traveller)) #данную строчку можно не использовать, так как если будет даже NA у тех, кто ставил высшую оценку, то это тоже показатель; но в этих данных нет высшей оценки среди NA (можно просто проследить самостоятельно по таблице, так как данных не так много остается)
airport1 <- filter(airport1, queuing_rating == '10')
show(airport1$type_traveller)


airport2 <- group_by(airport, type_traveller, queuing_rating)
airport2 <- summarise(airport2)


resultss <- ggplot(data=na.omit(airport2)) +
  geom_point(aes(x=type_traveller, y=queuing_rating), size = 2, shape = 21, alpha = 1) + theme_linedraw() + ggtitle("Взаимосвязь между типом путешественника \nи его оценкой очередей в аэропорту")   + labs(x = '\nТип путешественника', y = 'Оценка очередей') + 
 geom_point(data = airport1, aes(x=type_traveller, y=queuing_rating), size = 5, shape = 21, alpha = 1, fill = rgb(0, 0, 1, alpha = 0.4) )

resultss

```

**Ответ:** Business 

**Вывод:** 

Первое, что хотелось бы отметить, что из всех данных, которые есть для анализа, можно увидеть только одну единственную самую высокую оценку, которая была оставлена пассажиром, путешествующим по работе. Это может говорить о том, что в данном аэропорте существуют проблемы, которые касаются больших очередей. Безусловно, аэропорт Лондона обладает постоянным большим потоком людей, однако проблему  очередей есть необходимость решать для улучшения качества обслуживания. 

Чтобы более точно можно было сказать про проблемные места и способы их улучшения, хотелось бы иметь дополнительные данные (дальнейшние исследования), которые бы помогли выстроить систему регулярного сбора обратной связи / опросов за возможные бонусы лояльности, дополнительные скидки; проводить интервью часто летающих клиентов
Думаю, было бы полезно узнать следующее:

-среднее время стояния в очередях на разных контрольных точках

-количество необходимых контрольных точек, которые надо пройти, где потенциально могут быть длинные очереди

-количество работающих "свободных окошек" на данных точках контроля 
(например, если при паспортном контроле есть 8 окон, а открыто только 1 - вопрос, почему так)

В данный момент, мне кажется, что из результатов видно, что у аэропорта есть пробелы в обслуживании - очереди, ведь лишь один человек поставил 10. 

Возможные способы решения данной проблемы:

-проверка количества открытых стоек для пассажиров; цель - равномерно распределить нагрузку на работников аэропорта, чтобы не было застоев на контрольных точках - вовлекать больше сотрудников в процесс 

-распределять пассажиров по разным очередям (с багажом/без; с детьми/без детей, с животными/без и т.п.)

-уделить внимание распределению пассажиров и вылетов; крупные рейсы распределять в течении дня, распределять пассажиров по аэропорту, чтобы несколько больших потоков на рейсы не находились в одном месте (разные gates, стойки регистрации далеко друг от друга, паспортный контроль в разных местах)


Думаю, что вовлечение большего числа сотрудников и распределение вылетов в течении дня + распределение пассажиров могут благоприятно сказаться на очередях. 



#### Вопрос 2

**Вопрос:** Пользователи каких стран чаще употребляют слово "good" (но не "not good") в отрицательных отзывах на авиалинии? Т.е. находят что-то хорошее, но в целом не рекомендуют.

**Данные:** для ответа на вопрос нужны таблицы airline, seat, lounge

```{r message = FALSE, warning=FALSE, echo = F}

all4 = airline %>% full_join(lounge) %>% full_join(seat) 

#all42 <- filter(all4, !is.na(content) )
#all42 <- uniquewt.df (all42$content) #в этом моменте я пробовала убрать дупликаты, так как функция unique показала, что есть якобы три повторения в столбике content, но обратная ей функция не работает, возможно, это ошибка, которую я не учту дальше

rec <- filter(all4, recommended == '0')
rec <- mutate(rec, content = str_to_lower(rec$content))
rec <- mutate(rec, not_good = str_detect(rec$content, "not good"))
rec <- filter(rec, not_good == "FALSE")
rec <- mutate(rec, good = str_detect(rec$content, "good"))
rec <- filter(rec, good == "TRUE")


reccountries <-  summarise(group_by(rec, author_country), total = n())
reccountries <- filter(reccountries, !is.na(author_country) )

reccountries <-reccountries[order(-reccountries$total),]
mmean <- mean(reccountries$total)
recommendationscountries <- filter(reccountries, total > mmean)
recommendationscountries

resultasavariant <- boxplot(reccountries$total, xlab = "Частота употребления слова good в негативных отзывах", ylab = "Количество слова good в отзывах",
col.axis = "darkblue", lwd = 0.5,  col = rgb(0, 0, 1, alpha = 0.4), whiskcol = "darkblue", lty = 7) 


```

**Ответ:** United Kingdom, United States,Australia, Canada, Germany

**Вывод:** 
Данные показывают, что люди из этих стран чаще всего используют слово good в своих отзывах о компаниях, которые при этом они не рекомендуют. 
Это может говорить, в первую очередь, о том, что люди из этих стран могут даже в какой-то негативной ситуации найти что-то хорошее, мне кажется, что тут еще роль играет культура в данных странах, вежливость. Возможно, есть смысл анализировать данные отзывы более тщательно и больше внимания уделять тем минусам, на которые было указано в этих отзывах, так как даже несмотря на то, что можно выделить что-то хорошее, человек получил негативный опыт, который заставил его поменять свою точку зрения и не рекомендовать данные авиалинии. 

Возможно, авиакомпании, которыми летают в основном пассажиры данных стран , чаще просят написать отзыв, обещая скидку в дальнейшем. 
Помимо этого мне кажется, что есть смысл уделить внимание тем good points, которые были указаны в отзывах граждан 5 выделенных стран, эти данные дадут представление о том, какие у компании сильные стороны, чтобы при дальнейшей концентрации на исправлении недочетов, авиакомпании не забыли поддерживать свой уровень и сильные стороны. 
Возможно, есть смысл больше внимания уделять "мелочам" при обслуживании клиентов из этих стран, более "трепетно" относиться к ним, так как они имеют тенденцию говорить о хорошем. Мне кажется, что если исправить недочеты, которые привели к негативной реакции после good points, то клиенты из этих стран смогут дать достаточно качественный фидбек, который сыграет на руку компании. 


Для дальнейшнего исследования:

-тщательнее проанализировать полученные данные (плюсы и минусы, которые были уже отмечены клиентами)

-возможно стоит собирать обратную связь от клиентов более структурированно (например, отдельно спрашивать про плюсы и минусы)

-хотелось бы получить некое ранжирование от клиентов (допустим, это было достаточно хорошо, но это не так важно, как проблемы с ....)

Исправление сервиса:

Сложно сказать, что и как надо поменять в данной ситуации, так как мы больше получили информацию о клиентах, а не о компании. 

-при работе с данными клиентами стоит не допускать погрешностей, либо же максимально быстро их исправлять

-возможно, есть смысл относиться к этим клиентам немного иначе (лучше готовиться, быть готовым оперативно исправлять недоразумения)

-прислушаться к минусам, на которые указали клиенты из выделенных мной стран и исправить их, при этом не забывая о поддержание того, что клиентам понравилось, на высоком уровне




#### Вопрос 3

**Вопрос:** Есть ли взаимосвязь между средним рейтингом разных моделей самолета (aircraft) по критерию комфортности кресла (seat_comfort) и средней оценкой моделей самолетов по местам для хранения (seat_storage)?

**Данные:** для ответа на вопрос нужна таблица aircraft

```{r message = FALSE, warning=FALSE, echo = F}
aircraftmodel <- filter(airline, !is.na(aircraft))
aircraftmodel <- filter(aircraftmodel, !is.na(seat_comfort_rating))
aircraftmodel2 <- aircraftmodel %>% group_by(aircraft) %>% summarise_at(vars(seat_comfort_rating), list(meanseatcomf = mean))


seatrating <- filter(seat, !is.na(aircraft))
seatrating <- filter(seat, !is.na(seat_storage_rating))

seatrating2 <- seatrating %>% group_by(aircraft) %>% summarise_at(vars(seat_storage_rating), list(meanstorage = mean))

aircraftoverall <- aircraftmodel2 %>% full_join(seatrating2)

resultsaircraft1 <- ggplot(data=na.omit(aircraftoverall)) +
  geom_point(aes(x=meanseatcomf, y=meanstorage, fill = aircraft), size = 4.5, shape = 21, alpha = 0.8) + theme_linedraw() + ggtitle("Взаимосвязь между средним рейтингом \n разных моделей самолета по критерию \n комфортности кресла и средней оценкой \n  моделей самолетов по местам для хранения ")  + labs(caption = "\nне судите строго, я пытаюсь...") + labs(x = 'Комфортность сидения', y = 'Оценка места для хранения')
resultsaircraft1

resultsaircraft <- ggplot(data=na.omit(aircraftoverall), aes(x=meanseatcomf, y=meanstorage)) +
  geom_point() + ggtitle("Взаимосвязь между средним рейтингом \nразных моделей самолета по критерию \nкомфортности кресла и средней оценкой \nмоделей самолетов по местам для хранения ")  + labs(caption = "\nлиния тренда показывает обратную зависимость") + labs(x = 'Комфортность сидения', y = 'Оценка места для хранения') + geom_smooth(method = "lm") 
resultsaircraft


```

**Ответ:** Существует обратная взаимосвязь между оценкой комфортности сидения в самолете и оценкой моделей самолетов по местам для хранения

**Вывод:** 
На графике видно, что чем выше средняя оценка у модели самолета по критерию комфортности места, тем ниже средняя оценка у данной модели по местам для хранения. Это может говорить о том, что в самолетах разных моделей уделяется внимание одному из пунктов: либо комфортное место, либо хорошее место для хранения. Компании концентрируются на чем то одном, а не уделяют внимание и местам пассажиров, и местам для хранения. 

Практические решения:

-в тех моделях, где низкие оценки за места пассажиров - улучшить данный пробел, при этом не ухудшить места для хранения

-в тех моделях, где низкие оценки за места для хранения - улучшить их, не забывая про места пассажиров - найти баланс в этом

-ввести дополнительные пункты при оформлении билета, например, выбор более широкого места, бесплатная онлайн регистрация для пассажиров, так как дополнительная плата не всех может устроить

Планы на дальнейшее исследование:

-более подробно изучить, что не понравилось пассажирам, чтобы понимать лучше, что необходимо исправлять

-изучить места для хранения (чтобы на каждого человека было достаточно места, ограничивать провоз ручной клади у пассажиров)

-мне кажется, что есть смысл попробовать добавить большее количество видов мест (не только эконом, бизнес, дополнительное место для ног), потому что допустим для людей с избыточной массой тела будет недостаточно комфортно сидеть на простых местах для пассажиров, из-за чего они могут ниже оценить авиалинии по данному критерию 




### Дэшборд

Полученные выводы обобщены в виде дэшборда со следующими элементами 

**Элемент 1:** 

 - график
 
 - ответ на вопрос: Есть ли взаимосвязь между средним рейтингом разных моделей самолета (aircraft) по критерию комфортности кресла (seat_comfort) и средней оценкой моделей самолетов по местам для хранения (seat_storage)?
 
 - обоснование: Данный график показывает какого рода есть взаимосвязь между двумя переменными, это очень хорошо может проиллюстрировать, что чем лучше условия для багажа, тем хуже комфорт мест и наоборот. Что позволяет увидеть, на чем стоит концентрироваться компанииям, что не стоит забывать об одном, улучшая другое. 
 
**Элемент 2:** 

 - вид: Число
 
 - ответ на вопрос: Есть ли взаимосвязь между средним рейтингом разных моделей самолета (aircraft) по критерию комфортности кресла (seat_comfort) и средней оценкой моделей самолетов по местам для хранения (seat_storage)?
 
 - обоснование: Я выделила отдельно это число, чтобы показать, как клиенты оценивают комфортность мест. Мне кажется, что этот результат достаточно низкий, так как комфортное перемещение из одной точки в другую  - одно из главных желаний пассажиров. Зная среднюю оценку среди авиакомпаний можно сделать вывод о необходимости улучшения данного критерия. 
 
**Элемент 3:** 

 - вид: График
 
 - ответ на вопрос: Вопрос 2
 
 - обоснование: Этот график подобен первому, но я решила его добавить отдельно, так как он показывает, у каких моделей самолетов какие плюсы и минусы. Это поможет авиакомпаниям понимать, где на что надо сделать упор.
 
**Элемент 4:** 

 - вид: Число
 
 - ответ на вопрос: Вопрос 2
 
 - обоснование: Так как свой дэшборд я решила сделать по одному конкретному вопросу, мне кажется, что для полноты картины необходимо иметь представление о том, какой средний балл ставят клиенты авиакомпаний оценивая места для хранения. Видно, что данная оценка ниже, чем комфортность мест. Это говорит о том, что в целом среди всех моделей самолетов стоит исправлять данную проблему, так как это важно для клиентов. 
 
### Общие выводы

Данный анализ показывает, какие проблемы есть у авиакомпаний и аэропортов. Благодаря результатам небольшого анализа можно понять, на что стоит обращать больше внимания, что стоит исправить. Мне кажется, что даже такой анализ может помочь авиакомпаниям улучшить свой рейтинг, что в конечном итоге приведет к бОльшему спросу. 